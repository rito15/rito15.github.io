<!DOCTYPE html>



<html lang="en" 
  
    mode="dark"
  
>

  <!--
  The Head
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="theme" content="Chirpy v2.7.2">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="C# 패킷을 byte[]로 직렬화하는 다양한 방법" />
<meta name="author" content="Rito15" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Note" />
<meta property="og:description" content="Note" />
<link rel="canonical" href="https://rito15.github.io/posts/cs-serializations-to-byte-array/" />
<meta property="og:url" content="https://rito15.github.io/posts/cs-serializations-to-byte-array/" />
<meta property="og:site_name" content="Rito15" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-08T02:34:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="C# 패킷을 byte[]로 직렬화하는 다양한 방법" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"description":"Note","datePublished":"2021-08-08T02:34:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://rito15.github.io/posts/cs-serializations-to-byte-array/"},"url":"https://rito15.github.io/posts/cs-serializations-to-byte-array/","author":{"@type":"Person","name":"Rito15"},"headline":"C# 패킷을 byte[]로 직렬화하는 다양한 방법","dateModified":"2021-08-08T02:34:00+09:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>C# 패킷을 byte[]로 직렬화하는 다양한 방법 | Rito15
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2019 Cotes Chung
  Published under the MIT license
-->



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
  Chirpy v2.3
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT Licensed
-->






<link rel="preload" href="/assets/css/post.css" as="style">
<link rel="stylesheet" href="/assets/css/post.css">


  
    <link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css">
    <link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" />
  



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
  Chirpy v2.3
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT Licensed
-->





<script async src="/assets/js/post.min.js"></script>


  <!-- MathJax -->
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/favicons/android-icon-192x192.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Rito15</a>
    </div>

    <div class="site-subtitle font-italic">Unity Csharp Developer</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/tabs/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tabs/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tabs/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tabs/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/rito15" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ghdtkals15','gmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->
<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">
      
        
        <span>
          <a href="/">
            Posts
          </a>
        </span>
        
      

      
        <span>C# 패킷을 byte[]로 직렬화하는 다양한 방법</span>
      

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>C# 패킷을 byte[]로 직렬화하는 다양한 방법</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sun, Aug  8, 2021,  2:34 AM +0900"
  >

  
  

  
    Aug  8
  

  <i class="unloaded">2021-08-08T02:34:00+09:00</i>

</span>
          by
          <span class="author">
            Rito15
          </span>
        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->






<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6817 words">37 min</span>


          <!-- page views -->
          

          <!-- HITS -->
          &nbsp;
          <a href="https://hits.seeyoufarm.com"><img min-width="94" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://rito15.github.io/posts/cs-serializations-to-byte-array/%2F&count_bg=%23AC58FA&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false"/></a> 

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h1 id="note">Note</h1>
<hr />

<ul>
  <li>
    <p>비교적 단순한 형태의 패킷들을 정의한다.</p>
  </li>
  <li>
    <p>패킷을 다양한 방법으로 직렬화하여 <code class="language-plaintext highlighter-rouge">byte[]</code> 타입 버퍼에 순서대로 넣으며, 성능을 검사한다.</p>
  </li>
  <li>
    <p>직렬화된 결과의 크기는 패킷 내 모든 필드의 크기의 합이어야 한다.</p>
  </li>
  <li>
    <p>문자열 패킷은 어차피 공통적으로 인코딩을 거쳐야 하므로, 제외한다.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">BenchmarkDotNet</code>을 통해 벤치마크를 진행한다.</p>
  </li>
</ul>

<p><br /></p>

<h1 id="패킷-정의">패킷 정의</h1>
<hr />

<details>
  <summary> 
Source Code
</summary>

  <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">Packet</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">ushort</span> <span class="n">size</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">ushort</span> <span class="n">id</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">Packet</span><span class="p">(</span><span class="kt">ushort</span> <span class="n">id</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">id</span> <span class="p">=</span> <span class="n">id</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)</span> <span class="p">*</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Int3Packet</span> <span class="p">:</span> <span class="n">Packet</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">Int3Packet</span><span class="p">(</span><span class="kt">ushort</span> <span class="n">id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="n">y</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">z</span> <span class="p">=</span> <span class="n">z</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)</span> <span class="p">*</span> <span class="m">2</span> <span class="p">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">*</span> <span class="m">3</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">TransformPacket</span> <span class="p">:</span> <span class="n">Packet</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">posX</span><span class="p">,</span> <span class="n">posY</span><span class="p">,</span> <span class="n">posZ</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">rotX</span><span class="p">,</span> <span class="n">rotY</span><span class="p">,</span> <span class="n">rotZ</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">scaleX</span><span class="p">,</span> <span class="n">scaleY</span><span class="p">,</span> <span class="n">scaleZ</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">TransformPacket</span><span class="p">(</span><span class="kt">ushort</span> <span class="n">id</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)</span> <span class="p">*</span> <span class="m">2</span> <span class="p">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="p">*</span> <span class="m">9</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<p><br /></p>

<h1 id="필드-정의">필드 정의</h1>
<hr />

<details>
  <summary> 
Source Code
</summary>

  <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">const</span> <span class="kt">int</span> <span class="n">USHORT_SIZE</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">INT_SIZE</span>    <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">FLOAT_SIZE</span>  <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span>

<span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">1024</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">offset</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">Packet</span>            <span class="n">packet</span>  <span class="p">=</span> <span class="k">new</span> <span class="nf">Packet</span><span class="p">(</span><span class="m">1234</span><span class="p">);</span>
<span class="n">Int3Packet</span>    <span class="n">int3Packet</span>  <span class="p">=</span> <span class="k">new</span> <span class="nf">Int3Packet</span><span class="p">(</span><span class="m">2345</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">102030</span><span class="p">,</span> <span class="m">99999999</span><span class="p">);</span>
<span class="n">TransformPacket</span> <span class="n">trPacket</span>  <span class="p">=</span> <span class="k">new</span> <span class="nf">TransformPacket</span><span class="p">(</span><span class="m">3456</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">posX</span> <span class="p">=</span> <span class="m">1.1f</span><span class="p">,</span> <span class="n">posY</span> <span class="p">=</span> <span class="m">2.2f</span><span class="p">,</span> <span class="n">posZ</span> <span class="p">=</span> <span class="m">3.3f</span><span class="p">,</span>
    <span class="n">rotX</span> <span class="p">=</span> <span class="m">123.456f</span><span class="p">,</span> <span class="n">rotY</span> <span class="p">=</span> <span class="m">234.567f</span><span class="p">,</span> <span class="n">rotZ</span> <span class="p">=</span> <span class="m">345.678f</span><span class="p">,</span>
    <span class="n">scaleX</span> <span class="p">=</span> <span class="m">10000f</span><span class="p">,</span> <span class="n">scaleY</span> <span class="p">=</span> <span class="m">20000f</span><span class="p">,</span> <span class="n">scaleZ</span> <span class="p">=</span> <span class="m">30000f</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<p><br /></p>

<h1 id="직렬화-방법들">직렬화 방법들</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <h2 id="binaryformatterserialize"><strong>[0] BinaryFormatter.Serialize()</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">BinaryFormatter</span> <span class="n">bf</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">BinaryFormatter</span><span class="p">();</span> <span class="c1">// Field</span>

<span class="k">using</span> <span class="p">(</span><span class="n">MemoryStream</span> <span class="n">ms</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="m">1024</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">bf</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">packet</span><span class="p">);</span>

    <span class="kt">byte</span><span class="p">[]</span> <span class="n">arr</span> <span class="p">=</span> <span class="n">ms</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">arr</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>
        <p>단순히 <code class="language-plaintext highlighter-rouge">ushort</code> 필드 2개만 갖고 있는 클래스를 직렬화했을 때 결과 <code class="language-plaintext highlighter-rouge">byte[]</code> 배열의 길이가 <code class="language-plaintext highlighter-rouge">183</code>이 나온다.</p>
      </li>
      <li>
        <p>필드 외에, 클래스 관련된 수많은 정보들을 담고 있다는 뜻이므로 네트워크 통신을 위한 패킷 직렬화 방식으로는 부적절하다.</p>
      </li>
      <li>
        <p>따라서 <strong>테스트에 사용하지 않는다.</strong></p>
      </li>
    </ul>

  </details>

  <p><br /></p>

  <h2 id="bitconvertergetbytes"><strong>[1] BitConverter.GetBytes()</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">));</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>가장 단순하고도 직관적인 방법이다.</li>
      <li>각각의 필드를 <code class="language-plaintext highlighter-rouge">byte[]</code>로 변환하여 순서대로 버퍼에 담는다.</li>
      <li>필드마다 <code class="language-plaintext highlighter-rouge">byte[]</code>를 생성하므로, 항상 <code class="language-plaintext highlighter-rouge">GC</code>를 호출한다는 단점이 있다.</li>
    </ul>

  </details>

  <p><br /></p>

  <h2 id="bitconvertertrywritebytes"><strong>[2] BitConverter.TryWriteBytes()</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">.NET 5.0</code> 또는 <code class="language-plaintext highlighter-rouge">.NET Core 2.1</code> 이상에서 사용할 수 있다.</li>
      <li>배열을 따로 생성하지 않고, 직렬화된 결과를 대상 <code class="language-plaintext highlighter-rouge">byte[]</code> 배열의 특정 위치에 바로 복사한다.</li>
    </ul>

  </details>

  <p><br /></p>

  <h2 id="span-memorymarshal"><strong>[3] Span, MemoryMarshal</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">AsBytes</span><span class="p">(</span><span class="k">stackalloc</span> <span class="kt">ushort</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">{</span> <span class="n">data</span> <span class="p">});</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)));</span>
<span class="p">}</span>

<span class="c1">// 추가 : 성능 20~30% 향상된 방식</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">ushort</span><span class="p">&gt;</span> <span class="n">span</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">CreateReadOnlySpan</span><span class="p">(</span><span class="k">ref</span> <span class="n">data</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
    <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="n">Cast</span><span class="p">&lt;</span><span class="kt">ushort</span><span class="p">,</span> <span class="kt">byte</span><span class="p">&gt;(</span><span class="n">span</span><span class="p">);</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)));</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">.NET 5.0</code> 또는 <code class="language-plaintext highlighter-rouge">.NET Core 2.1</code> 이상에서 사용할 수 있다.</li>
      <li>힙 할당 없이 스택 할당으로 배열을 생성하고, 목표 <code class="language-plaintext highlighter-rouge">byte[]</code> 배열의 특정 위치에 바로 복사한다.</li>
    </ul>

  </details>

  <p><br /></p>

  <h2 id="unsafe--"><strong>[4] Unsafe 포인터 캐스팅</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">unsafe</span>
    <span class="p">{</span>
        <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="p">*(</span><span class="kt">ushort</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>컴파일 옵션으로 <code class="language-plaintext highlighter-rouge">/unsafe</code>를 허용해야 한다.</li>
      <li>포인터를 통해 메모리에 직접 접근하여 값을 변경한다.</li>
    </ul>

  </details>

  <p><br /></p>

  <h2 id="bit---"><strong>[5] Bit 연산을 통한 분리</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">UshortOffsetLookup</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">8</span> <span class="p">};</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">data</span> <span class="p">&gt;&gt;</span> <span class="n">UshortOffsetLookup</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>정수 타입의 값에 대해서만 가능하다.</li>
      <li>리틀 엔디안을 기준으로 작성하였다.</li>
      <li>빅 엔디안 시스템의 경우, <code class="language-plaintext highlighter-rouge">UshortOffsetLookup</code> 배열의 요소를 반대로 <code class="language-plaintext highlighter-rouge">8, 0</code>으로 넣어야 한다.</li>
      <li>엔디언은 <code class="language-plaintext highlighter-rouge">BitConverter.IsLittleEndian</code>으로 확인할 수 있다.</li>
    </ul>

  </details>

  <p><br /></p>

  <h2 id="union-"><strong>[6] 구조체를 union처럼 사용하기</strong></h2>

  <details>
    <summary> 
.
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionUshortByte2</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">ushort</span> <span class="k">value</span><span class="p">;</span>

    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">UnionUshortByte2</span> <span class="nf">New</span><span class="p">(</span><span class="kt">ushort</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionUshortByte2</span><span class="p">()</span> <span class="p">{</span> <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UnionUshortByte2</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionUshortByte2</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>동일한 메모리 주소를 서로 다른 필드가 공유하도록 한다.</li>
      <li>2바이트 크기에 <code class="language-plaintext highlighter-rouge">ushort</code> 타입으로 값을 넣은 뒤, 1바이트씩 <code class="language-plaintext highlighter-rouge">byte</code> 타입으로 값을 읽어들인다.</li>
    </ul>

  </details>

</details>

<p><br /></p>

<h1 id="직렬화를-위한-api-작성">직렬화를 위한 API 작성</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <ul>
    <li>위의 6가지 방법을 편리하게 사용할 수 있도록 메소드로 작성한다.</li>
    <li><code class="language-plaintext highlighter-rouge">ushort</code>, <code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">float</code> 타입에 대해 오버로딩한다.</li>
  </ul>

  <p><br /></p>

  <details>
    <summary> 
Definitions
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">UshortOffsetLookup</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">8</span> <span class="p">};</span>
<span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">IntOffsetLookup</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">16</span><span class="p">,</span> <span class="m">24</span> <span class="p">};</span>

<span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionUshortByte2</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">ushort</span> <span class="k">value</span><span class="p">;</span>

    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">UnionUshortByte2</span> <span class="nf">New</span><span class="p">(</span><span class="kt">ushort</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionUshortByte2</span><span class="p">()</span> <span class="p">{</span> <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionIntByte4</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">int</span> <span class="k">value</span><span class="p">;</span>

    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">2</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte2</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">3</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte3</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte2</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">3</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte3</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">UnionIntByte4</span> <span class="nf">New</span><span class="p">(</span><span class="kt">int</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionIntByte4</span><span class="p">()</span> <span class="p">{</span> <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionFloatByte4</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">float</span> <span class="n">floatValue</span><span class="p">;</span>

    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">2</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte2</span><span class="p">;</span>
    <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">3</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte3</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte2</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">3</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte3</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">UnionFloatByte4</span> <span class="nf">New</span><span class="p">(</span><span class="kt">float</span> <span class="k">value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionFloatByte4</span><span class="p">()</span> <span class="p">{</span> <span class="n">floatValue</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <details>
    <summary> 
APIs
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
</pre></td><td class="rouge-code"><pre><span class="c1">// [1]</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">));</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">));</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// [2]</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// [3]</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">AsBytes</span><span class="p">(</span><span class="k">stackalloc</span> <span class="kt">ushort</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">{</span> <span class="n">data</span> <span class="p">});</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)));</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">AsBytes</span><span class="p">(</span><span class="k">stackalloc</span> <span class="kt">int</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">{</span> <span class="n">data</span> <span class="p">});</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)));</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">AsBytes</span><span class="p">(</span><span class="k">stackalloc</span> <span class="kt">float</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">{</span> <span class="n">data</span> <span class="p">});</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)));</span>
<span class="p">}</span>

<span class="c1">// [4]</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">unsafe</span>
    <span class="p">{</span>
        <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="p">*(</span><span class="kt">ushort</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">unsafe</span>
    <span class="p">{</span>
        <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="p">*(</span><span class="kt">int</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">unsafe</span>
    <span class="p">{</span>
        <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="p">*(</span><span class="kt">float</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// [5]</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">data</span> <span class="p">&gt;&gt;</span> <span class="n">UshortOffsetLookup</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">data</span> <span class="p">&gt;&gt;</span> <span class="n">IntOffsetLookup</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// [6]</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UnionUshortByte2</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionUshortByte2</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UnionIntByte4</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionIntByte4</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UnionFloatByte4</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionFloatByte4</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

</details>

<p><br /></p>

<h1 id="벤치마크-공통-조건">벤치마크 공통 조건</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>BenchmarkDotNet=v0.13.0, OS=Windows 10.0.18362.720 (1903/May2019Update/19H1)
Intel Core i7-9750H CPU 2.60GHz, 1 CPU, 12 logical and 6 physical cores
.NET SDK=5.0.301
  [Host]     : .NET Core 3.1.16 (CoreCLR 4.700.21.26205, CoreFX 4.700.21.26205), X64 RyuJIT
  Job-FTADDV : .NET Core 3.1.16 (CoreCLR 4.700.21.26205, CoreFX 4.700.21.26205), X64 RyuJIT
  
Invocation Count : 50,000,000
Launch Count : 5
Warmup Count : 3
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<p><br /></p>

<h1 id="벤치마크-1">벤치마크 1</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">ushort</code> 필드 2개를 직렬화한다.</li>
  </ul>

  <p><br /></p>

  <h2 id="section"><strong>소스 코드</strong></h2>

  <details>
    <summary> 
Source Code
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_GetBytes_1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Span_1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Unsafe_1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitCalculation_1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">UnionStruct_1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <p><br /></p>

  <h2 id="section-1"><strong>결과</strong></h2>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128601792-9a871b99-93f5-4b99-8d9f-f90cfdfb3a0e.png" alt="image" /></p>

</details>

<p><br /></p>

<h1 id="벤치마크-2">벤치마크 2</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">ushort</code> 필드 2개와 <code class="language-plaintext highlighter-rouge">int</code> 필드 3개를 직렬화한다.</li>
  </ul>

  <p><br /></p>

  <h2 id="section-2"><strong>소스 코드</strong></h2>

  <details>
    <summary> 
Source Code
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_GetBytes_2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Span_2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Unsafe_2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitCalculation_2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">UnionStruct_2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>    <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <p><br /></p>

  <h2 id="section-3"><strong>결과</strong></h2>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128601790-d5ff439a-c990-41c0-ab56-b48323836ab4.png" alt="image" /></p>

</details>

<p><br /></p>

<h1 id="벤치마크-3">벤치마크 3</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">ushort</code> 필드 2개와 <code class="language-plaintext highlighter-rouge">float</code> 필드 9개를 직렬화한다.</li>
    <li>bit 연산 방식은 <code class="language-plaintext highlighter-rouge">float</code>에 적용할 수 없으므로 제외한다.</li>
  </ul>

  <p><br /></p>

  <h2 id="section-4"><strong>소스 코드</strong></h2>

  <details>
    <summary> 
Source Code
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_GetBytes_3</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>     <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_3</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>     <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Span_3</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>     <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Unsafe_3</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>     <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// float는 Bit 연산 불가 //</span>

<span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">UnionStruct_3</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>       <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>     <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span>   <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
    <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <p><br /></p>

  <h2 id="section-5"><strong>결과</strong></h2>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128602631-f4e37e8d-454a-4f70-b7ca-f249976050f7.png" alt="image" /></p>

</details>

<p><br /></p>

<h1 id="결론">결론</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <h2 id="section-6"><strong>성능 순서</strong></h2>

  <ol>
    <li><code class="language-plaintext highlighter-rouge">unsafe</code>를 통한 메모리 직접 접근, <code class="language-plaintext highlighter-rouge">BitConverter.TryWriteBytes()</code>
      <ul>
        <li>데이터가 적을 때는 확실히 <code class="language-plaintext highlighter-rouge">unsafe</code>가 빠르지만, 많아질수록 격차가 줄어든다.</li>
      </ul>
    </li>
    <li><code class="language-plaintext highlighter-rouge">Span&lt;T&gt;</code>, 비트 연산
      <ul>
        <li>비트 연산이 조금 더 빠르지만 큰 차이는 없다.</li>
        <li>비트 연산은 정수에만 사용 가능하다는 치명적인 단점이 있다.</li>
      </ul>
    </li>
    <li><code class="language-plaintext highlighter-rouge">union</code> 구조체
      <ul>
        <li><code class="language-plaintext highlighter-rouge">unsafe</code>를 사용할 수 없고, <code class="language-plaintext highlighter-rouge">.NET</code> 버전도 낮다면 고려할만하다.</li>
      </ul>
    </li>
    <li><code class="language-plaintext highlighter-rouge">BitConverter.GetBytes()</code>
      <ul>
        <li>압도적으로 느리다.</li>
      </ul>
    </li>
  </ol>

</details>

<p><br /></p>

<h1 id="추가-벤치마크-1--직렬화-api에-따른-성능-차이">추가 벤치마크 1 : 직렬화 API에 따른 성능 차이</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <h2 id="section-7">테스트 대상</h2>

  <ol>
    <li>인라인 방식 : <code class="language-plaintext highlighter-rouge">BitConverter.TryWriteBytes()</code> 직접 호출</li>
    <li>메소드 반복 호출 : <code class="language-plaintext highlighter-rouge">Serialize_TryWriteBytes()</code> 반복 호출</li>
    <li><code class="language-plaintext highlighter-rouge">params</code> 메소드 호출 : <code class="language-plaintext highlighter-rouge">params</code> 인자로 한 번에 전달</li>
  </ol>

  <p><br /></p>

  <h2 id="api">직렬화 API</h2>

  <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1">// [1] 인라인 방식으로 직접 사용</span>

<span class="c1">// [2] 메소드 하나에 데이터 1개 직렬화</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// [3] params를 이용해 데이터 한번에 직렬화</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="k">params</span> <span class="kt">ushort</span><span class="p">[]</span> <span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">Len</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">i</span> <span class="p">*</span> <span class="n">Len</span><span class="p">,</span> <span class="n">Len</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>  </div>

  <p><br /></p>

  <h2 id="ushort--2-">[1] ushort 변수 2개 직렬화</h2>

  <details>
    <summary> 
Source Code
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_A</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_B</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_C</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128597526-8e0d95de-a492-4bb6-91ba-313814ba3e10.png" alt="image" /></p>

  <p><br /></p>

  <h2 id="ushort--5-">[2] ushort 변수 5개 직렬화</h2>

  <details>
    <summary> 
Source Code
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_1</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_2</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_3</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>

<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_A</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>  <span class="n">ushort_1</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>  <span class="n">ushort_2</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">8</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>  <span class="n">ushort_3</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_B</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span>  <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">4</span><span class="p">,</span>  <span class="n">ushort_1</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">6</span><span class="p">,</span>  <span class="n">ushort_2</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">8</span><span class="p">,</span>  <span class="n">ushort_3</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_C</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">ushort_1</span><span class="p">,</span> <span class="n">ushort_2</span><span class="p">,</span> <span class="n">ushort_3</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128597833-cfe5497a-5286-43a9-b32b-ba6763a0fab8.png" alt="image" /></p>

  <p><br /></p>

  <h2 id="ushort--10-">[3] ushort 변수 10개 직렬화</h2>

  <details>
    <summary> 
Source Code
</summary>

    <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_1</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_2</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_3</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_4</span> <span class="p">=</span> <span class="m">4</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_5</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_6</span> <span class="p">=</span> <span class="m">6</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_7</span> <span class="p">=</span> <span class="m">7</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">ushort</span> <span class="n">ushort_8</span> <span class="p">=</span> <span class="m">8</span><span class="p">;</span>

<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_A</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>  <span class="n">ushort_1</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>  <span class="n">ushort_2</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">8</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>  <span class="n">ushort_3</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">10</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">ushort_4</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">12</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">ushort_5</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">14</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">ushort_6</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">16</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">ushort_7</span><span class="p">);</span>
    <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">18</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">ushort_8</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_B</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span>  <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">4</span><span class="p">,</span>  <span class="n">ushort_1</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">6</span><span class="p">,</span>  <span class="n">ushort_2</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">8</span><span class="p">,</span>  <span class="n">ushort_3</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">10</span><span class="p">,</span> <span class="n">ushort_4</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">12</span><span class="p">,</span> <span class="n">ushort_5</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">14</span><span class="p">,</span> <span class="n">ushort_6</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">16</span><span class="p">,</span> <span class="n">ushort_7</span><span class="p">);</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="m">18</span><span class="p">,</span> <span class="n">ushort_8</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">Benchmark</span><span class="p">]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_C</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">ushort_1</span><span class="p">,</span> <span class="n">ushort_2</span><span class="p">,</span> <span class="n">ushort_3</span><span class="p">,</span> <span class="n">ushort_4</span><span class="p">,</span>
        <span class="n">ushort_5</span><span class="p">,</span> <span class="n">ushort_6</span><span class="p">,</span> <span class="n">ushort_7</span><span class="p">,</span> <span class="n">ushort_8</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>    </div>

  </details>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128598226-b7b0dc98-f440-4204-b65f-df25a6e188be.png" alt="image" /></p>

  <p><br /></p>

  <h2 id="section-8"><strong>결론</strong></h2>

  <ol>
    <li>인라인 방식과 인자 1개를 넣는 메소드의 성능은 유의미한 차이가 없다.</li>
    <li>변수의 개수가 많을수록 <code class="language-plaintext highlighter-rouge">params</code>를 이용하는 메소드가 더 유리하지만, 역시 큰 차이는 없다.</li>
  </ol>

</details>

<p><br /></p>

<h1 id="추가-벤치마크-2--span-방식-개선">추가 벤치마크 2 : Span 방식 개선</h1>
<hr />

<details>
  <summary> 
…
</summary>

  <h2 id="section-9"><strong>소스 코드</strong></h2>

  <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c1">// 공통 필드</span>
<span class="k">public</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">1024</span><span class="p">];</span>
<span class="k">public</span> <span class="kt">int</span> <span class="n">offset</span> <span class="p">=</span> <span class="m">123</span><span class="p">;</span>
<span class="k">public</span> <span class="kt">float</span> <span class="n">data</span> <span class="p">=</span> <span class="m">123.456f</span><span class="p">;</span>

<span class="c1">// 기존</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Span1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">AsBytes</span><span class="p">(</span><span class="k">stackalloc</span> <span class="kt">float</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">{</span> <span class="n">data</span> <span class="p">});</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)));</span>
<span class="p">}</span>

<span class="c1">// 개선</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">Span2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span> <span class="n">fSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">CreateReadOnlySpan</span><span class="p">(</span><span class="k">ref</span> <span class="n">data</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
    <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="n">Cast</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">,</span> <span class="kt">byte</span><span class="p">&gt;(</span><span class="n">fSpan</span><span class="p">);</span>
    <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)));</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>  </div>

  <p><br /></p>

  <h2 id="section-10"><strong>결과</strong></h2>

  <h3 id="section-11"><strong>[1]</strong></h3>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Launch Count: 10
Warmup Count: 3
InvocationCount: 5,000,000
</pre></td></tr></tbody></table></code></div>  </div>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128606991-74aad060-89d4-4103-8e67-2e5a489a52fc.png" alt="image" /></p>

  <p><br /></p>

  <h3 id="section-12"><strong>[2]</strong></h3>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Launch Count: 10
Warmup Count: 3
InvocationCount: 50,000,000
</pre></td></tr></tbody></table></code></div>  </div>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128607126-33746971-6058-4b9d-9637-241e4925d367.png" alt="image" /></p>

  <p><br /></p>

  <h3 id="section-13"><strong>[3]</strong></h3>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Launch Count: 20
Warmup Count: 10
InvocationCount: 50,000,000
</pre></td></tr></tbody></table></code></div>  </div>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128607403-fce07fee-db76-4f30-8092-a5edd0baf564.png" alt="image" /></p>

  <p><br /></p>

  <h2 id="section-14"><strong>결론</strong></h2>

  <ul>
    <li>개선된 방식의 성능이 <code class="language-plaintext highlighter-rouge">20%</code> ~ <code class="language-plaintext highlighter-rouge">30%</code> 가량 더 좋다.</li>
  </ul>

  <p><br /></p>

  <h2 id="section-15"><strong>개선된 방식으로 직렬화 벤치마크 전체 다시 진행</strong></h2>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Launch Count: 5
Warmup Count: 3
InvocationCount: 50,000,000
</pre></td></tr></tbody></table></code></div>  </div>

  <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/128609134-24bd5fef-8635-4047-a9cf-c8a0e3bcd18d.png" alt="image" /></p>

  <ul>
    <li>이전 방식에 비해 딱 <code class="language-plaintext highlighter-rouge">30%</code>정도 성능이 향상된 것을 확인할 수 있다.</li>
  </ul>

</details>

<p><br /></p>

<h1 id="전체-소스코드">전체 소스코드</h1>
<hr />

<details>
  <summary> 
SerializationBenchmarks.cs
</summary>

  <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">BenchmarkDotNet.Attributes</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">BenchmarkDotNet.Configs</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>

<span class="p">[</span><span class="nf">GroupBenchmarksBy</span><span class="p">(</span><span class="n">BenchmarkLogicalGroupRule</span><span class="p">.</span><span class="n">ByCategory</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">SimpleJob</span><span class="p">(</span><span class="n">launchCount</span><span class="p">:</span> <span class="m">5</span><span class="p">,</span> <span class="n">warmupCount</span><span class="p">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">invocationCount</span><span class="p">:</span> <span class="m">50</span><span class="n">_000_000</span><span class="p">)]</span>
<span class="c1">//[CategoriesColumn]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">SerializationBenchmarks</span>
<span class="p">{</span>
    <span class="cm">/***********************************************************************
    *                               Packet Definitions
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Packet</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">ushort</span> <span class="n">size</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">ushort</span> <span class="n">id</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Packet</span><span class="p">(</span><span class="kt">ushort</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">id</span> <span class="p">=</span> <span class="n">id</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)</span> <span class="p">*</span> <span class="m">2</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Int3Packet</span> <span class="p">:</span> <span class="n">Packet</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Int3Packet</span><span class="p">(</span><span class="kt">ushort</span> <span class="n">id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="n">x</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="n">y</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">z</span> <span class="p">=</span> <span class="n">z</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)</span> <span class="p">*</span> <span class="m">2</span> <span class="p">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">*</span> <span class="m">3</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">TransformPacket</span> <span class="p">:</span> <span class="n">Packet</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">float</span> <span class="n">posX</span><span class="p">,</span> <span class="n">posY</span><span class="p">,</span> <span class="n">posZ</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">float</span> <span class="n">rotX</span><span class="p">,</span> <span class="n">rotY</span><span class="p">,</span> <span class="n">rotZ</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">float</span> <span class="n">scaleX</span><span class="p">,</span> <span class="n">scaleY</span><span class="p">,</span> <span class="n">scaleZ</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">TransformPacket</span><span class="p">(</span><span class="kt">ushort</span> <span class="n">id</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">size</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)</span> <span class="p">*</span> <span class="m">2</span> <span class="p">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="p">*</span> <span class="m">9</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
    <span class="cm">/***********************************************************************
    *                               Fields, Setups
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>

    <span class="k">public</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">Packet</span> <span class="n">packet</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">Int3Packet</span> <span class="n">int3Packet</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">TransformPacket</span> <span class="n">trPacket</span><span class="p">;</span>

    <span class="p">[</span><span class="n">GlobalSetup</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Setup</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">1024</span><span class="p">];</span>
        <span class="n">offset</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

        <span class="n">packet</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Packet</span><span class="p">(</span><span class="m">1234</span><span class="p">);</span>
        <span class="n">int3Packet</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Int3Packet</span><span class="p">(</span><span class="m">2345</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">102030</span><span class="p">,</span> <span class="m">99999999</span><span class="p">);</span>
        <span class="n">trPacket</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TransformPacket</span><span class="p">(</span><span class="m">3456</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">posX</span> <span class="p">=</span> <span class="m">1.1f</span><span class="p">,</span>
            <span class="n">posY</span> <span class="p">=</span> <span class="m">2.2f</span><span class="p">,</span>
            <span class="n">posZ</span> <span class="p">=</span> <span class="m">3.3f</span><span class="p">,</span>
            <span class="n">rotX</span> <span class="p">=</span> <span class="m">123.456f</span><span class="p">,</span>
            <span class="n">rotY</span> <span class="p">=</span> <span class="m">234.567f</span><span class="p">,</span>
            <span class="n">rotZ</span> <span class="p">=</span> <span class="m">345.678f</span><span class="p">,</span>
            <span class="n">scaleX</span> <span class="p">=</span> <span class="m">10000f</span><span class="p">,</span>
            <span class="n">scaleY</span> <span class="p">=</span> <span class="m">20000f</span><span class="p">,</span>
            <span class="n">scaleZ</span> <span class="p">=</span> <span class="m">30000f</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="n">IterationSetup</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">IterationSetup</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">1024</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">PrintBuffer</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\n============ Buffer ==============="</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"[</span><span class="p">{</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">}</span><span class="s">] </span><span class="p">{</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]}</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
    <span class="cm">/***********************************************************************
    *                               Lookups
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>

    <span class="k">const</span> <span class="kt">int</span> <span class="n">USHORT_SIZE</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">INT_SIZE</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">FLOAT_SIZE</span> <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span>

    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">UshortOffsetLookup</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">8</span> <span class="p">};</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">IntOffsetLookup</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">16</span><span class="p">,</span> <span class="m">24</span> <span class="p">};</span>

    <span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionUshortByte2</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">ushort</span> <span class="k">value</span><span class="p">;</span>

        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                    <span class="k">default</span><span class="p">:</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">UnionUshortByte2</span> <span class="nf">New</span><span class="p">(</span><span class="kt">ushort</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionUshortByte2</span><span class="p">()</span> <span class="p">{</span> <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionIntByte4</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">int</span> <span class="k">value</span><span class="p">;</span>

        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">2</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte2</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">3</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte3</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte2</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">3</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte3</span><span class="p">;</span>
                    <span class="k">default</span><span class="p">:</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">UnionIntByte4</span> <span class="nf">New</span><span class="p">(</span><span class="kt">int</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionIntByte4</span><span class="p">()</span> <span class="p">{</span> <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">StructLayout</span><span class="p">(</span><span class="n">LayoutKind</span><span class="p">.</span><span class="n">Explicit</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">struct</span> <span class="nc">UnionFloatByte4</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">float</span> <span class="n">floatValue</span><span class="p">;</span>

        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">0</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte0</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte1</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">2</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte2</span><span class="p">;</span>
        <span class="p">[</span><span class="nf">FieldOffset</span><span class="p">(</span><span class="m">3</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">byte</span> <span class="n">byte3</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">byte</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">index</span><span class="p">]</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">switch</span> <span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte0</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte1</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte2</span><span class="p">;</span>
                    <span class="k">case</span> <span class="m">3</span><span class="p">:</span> <span class="k">return</span> <span class="n">byte3</span><span class="p">;</span>
                    <span class="k">default</span><span class="p">:</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IndexOutOfRangeException</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">UnionFloatByte4</span> <span class="nf">New</span><span class="p">(</span><span class="kt">float</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">UnionFloatByte4</span><span class="p">()</span> <span class="p">{</span> <span class="n">floatValue</span> <span class="p">=</span> <span class="k">value</span> <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
    <span class="cm">/***********************************************************************
    *                               Tool Methods
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">BitConverter</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="n">Array</span><span class="p">.</span><span class="nf">Copy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BitConverter</span><span class="p">.</span><span class="nf">TryWriteBytes</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)),</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">ushort</span><span class="p">&gt;</span> <span class="n">span</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">CreateReadOnlySpan</span><span class="p">(</span><span class="k">ref</span> <span class="n">data</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="n">Cast</span><span class="p">&lt;</span><span class="kt">ushort</span><span class="p">,</span> <span class="kt">byte</span><span class="p">&gt;(</span><span class="n">span</span><span class="p">);</span>
        <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">)));</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">span</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">CreateReadOnlySpan</span><span class="p">(</span><span class="k">ref</span> <span class="n">data</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="n">Cast</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">byte</span><span class="p">&gt;(</span><span class="n">span</span><span class="p">);</span>
        <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)));</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Span</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span> <span class="n">span</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="nf">CreateReadOnlySpan</span><span class="p">(</span><span class="k">ref</span> <span class="n">data</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">ReadOnlySpan</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">bSpan</span> <span class="p">=</span> <span class="n">MemoryMarshal</span><span class="p">.</span><span class="n">Cast</span><span class="p">&lt;</span><span class="kt">float</span><span class="p">,</span> <span class="kt">byte</span><span class="p">&gt;(</span><span class="n">span</span><span class="p">);</span>
        <span class="n">bSpan</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="k">new</span> <span class="n">Span</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">)));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">unsafe</span>
        <span class="p">{</span>
            <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="p">*(</span><span class="kt">ushort</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">unsafe</span>
        <span class="p">{</span>
            <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="p">*(</span><span class="kt">int</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">unsafe</span>
        <span class="p">{</span>
            <span class="k">fixed</span> <span class="p">(</span><span class="kt">byte</span><span class="p">*</span> <span class="n">bPtr</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="n">offset</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="p">*(</span><span class="kt">float</span><span class="p">*)</span><span class="n">bPtr</span> <span class="p">=</span> <span class="n">data</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">data</span> <span class="p">&gt;&gt;</span> <span class="n">UshortOffsetLookup</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">data</span> <span class="p">&gt;&gt;</span> <span class="n">IntOffsetLookup</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">ushort</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">UnionUshortByte2</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionUshortByte2</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">ushort</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">UnionIntByte4</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionIntByte4</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">float</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">UnionFloatByte4</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">UnionFloatByte4</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">buffer</span><span class="p">[</span><span class="n">offset</span> <span class="p">+</span> <span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
    <span class="cm">/***********************************************************************
    *                               BenchMark1 - Simple Packet
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_GetBytes_1</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_1</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Span_1</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Unsafe_1</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitCalculation_1</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Simple Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">UnionStruct_1</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">USHORT_SIZE</span><span class="p">,</span> <span class="n">packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
    <span class="cm">/***********************************************************************
    *                               BenchMark2 - Int3 Packet
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_GetBytes_2</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_2</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Span_2</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Unsafe_2</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitCalculation_2</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_BitCalculation</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Int3 Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">UnionStruct_2</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">x</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">y</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">INT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">int3Packet</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
    <span class="cm">/***********************************************************************
    *                               BenchMark3 - Transform Packet
    ***********************************************************************/</span>
    <span class="err">#</span><span class="n">region</span> <span class="p">.</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="nf">Benchmark</span><span class="p">(</span><span class="n">Baseline</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_GetBytes_3</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_GetBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">BitConverter_TryWriteBytes_3</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_TryWriteBytes</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Span_3</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Span</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Unsafe_3</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_Unsafe</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// float는 Bit 연산 불가 //</span>

    <span class="p">[</span><span class="nf">BenchmarkCategory</span><span class="p">(</span><span class="s">"Transform Packet"</span><span class="p">),</span> <span class="n">Benchmark</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">UnionStruct_3</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">size</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">id</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">USHORT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">posZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">rotZ</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleX</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleY</span><span class="p">);</span> <span class="n">cur</span> <span class="p">+=</span> <span class="n">FLOAT_SIZE</span><span class="p">;</span>
        <span class="nf">Serialize_UnionStruct</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span> <span class="p">+</span> <span class="n">cur</span><span class="p">,</span> <span class="n">trPacket</span><span class="p">.</span><span class="n">scaleZ</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="err">#</span><span class="n">endregion</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<details>
  <summary> 
MainClass.cs
</summary>

  <div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">BenchmarkDotNet.Running</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MainClass</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BenchmarkRunner</span><span class="p">.</span><span class="n">Run</span><span class="p">&lt;</span><span class="n">SerializationBenchmarks</span><span class="p">&gt;();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>



      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/c/'>C#</a>,
            <a href='/categories/c-study/'>C# Study</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/csharp/"
            class="post-tag no-text-decoration" >csharp</a>
          
          <a href="/tags/benchmark/"
            class="post-tag no-text-decoration" >benchmark</a>
          
          <a href="/tags/serialization/"
            class="post-tag no-text-decoration" >serialization</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet

 v2.1
 https://github.com/cotes2020/jekyll-theme-chirpy
 © 2019 Cotes Chung
 Published under the MIT License
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=C# 패킷을 byte[]로 직렬화하는 다양한 방법 - Rito15&url=https://rito15.github.io/posts/cs-serializations-to-byte-array/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=C# 패킷을 byte[]로 직렬화하는 다양한 방법 - Rito15&u=https://rito15.github.io/posts/cs-serializations-to-byte-array/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=C# 패킷을 byte[]로 직렬화하는 다양한 방법 - Rito15&url=https://rito15.github.io/posts/cs-serializations-to-byte-array/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/posts/memo-cs-enum/">C# Enum 관련 메모</a></li>
      
        
        
        
        <li><a href="/posts/unity-opt-script-optimization/">유니티 스크립트 최적화</a></li>
      
        
        
        
        <li><a href="/posts/cs-gethashcode-cost-by-types/">C# 타입별 GetHashCode() 성능</a></li>
      
        
        
        
        <li><a href="/posts/unity-compute-shader/">유니티 - 컴퓨트 쉐이더(Compute Shader)</a></li>
      
        
        
        
        <li><a href="/posts/simple-amplify-shader-examples/">간단한 앰플리파이 쉐이더 예제 모음</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/csharp/">csharp</a>
      
        
        <a class="post-tag" href="/tags/unity/">unity</a>
      
        
        <a class="post-tag" href="/tags/editor/">editor</a>
      
        
        <a class="post-tag" href="/tags/shader/">shader</a>
      
        
        <a class="post-tag" href="/tags/memo/">memo</a>
      
        
        <a class="post-tag" href="/tags/graphics/">graphics</a>
      
        
        <a class="post-tag" href="/tags/opengl/">opengl</a>
      
        
        <a class="post-tag" href="/tags/thread/">thread</a>
      
        
        <a class="post-tag" href="/tags/amplify/">amplify</a>
      
        
        <a class="post-tag" href="/tags/plugin/">plugin</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.

 v2.0
 https://github.com/cotes2020/jekyll-theme-chirpy
 © 2019 Cotes Chung
 Published under the MIT License
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/cs-benchmark-dotnet/">
          <div class="card-body">
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago small"
  >

  
  

  
    Aug  7
  

  <i class="unloaded">2021-08-07T16:16:00+09:00</i>

</span>
            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# Benchmark DotNet</h3>
            <div class="text-muted small">
              <p>
                





                설치



  비주얼 스튜디오 - 프로젝트 - NuGet 패키지 관리 - Benchmark를 검색하여 설치




사용법


[1] 테스트 대상 클래스


  
    …
  

  [1-1] 네임스페이스

  
    1
&lt;summary&gt;  .
    
    &lt;/summary&gt;

    1
&lt;div class="langu...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/cs-why-should-inherit-iequatable/">
          <div class="card-body">
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago small"
  >

  
  

  
    Jul 19
  

  <i class="unloaded">2021-07-19T20:00:00+09:00</i>

</span>
            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# 구조체가 IEquatable&lt;T&gt;를 상속해야 하는 이유</h3>
            <div class="text-muted small">
              <p>
                





                System.Object.Equals(object)


C#의 모든 타입의 최상위 클래스인 Object에는 .Equals(object) 메소드가 존재한다.

그리고 이를 통해 다른 값과의 동일 비교를 수행할 수 있다.



구조체나 클래스를 직접 정의하고, 해당 객체로 .Equals(object)를 호출하면

object.Equals(object)가 ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/cs-arraysegment-span-memory/">
          <div class="card-body">
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago small"
  >

  
  

  
    Aug  8
  

  <i class="unloaded">2021-08-08T20:00:00+09:00</i>

</span>
            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# ArraySegment&lt;T&gt;, Span&lt;T&gt;, Memory&lt;T&gt;</h3>
            <div class="text-muted small">
              <p>
                





                Array



  https://docs.microsoft.com/ko-kr/dotnet/csharp/programming-guide/arrays/single-dimensional-arrays
  https://docs.microsoft.com/ko-kr/dotnet/api/system.array?view=net-5.0




특징

  고정된 크기...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.

  v2.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/cs-benchmark-dotnet/" class="btn btn-outline-primary">
    <p>C# Benchmark DotNet</p>
  </a>
  

  
  <a href="/posts/cs-heap-memory-debugger/" class="btn btn-outline-primary">
    <p>C# 간단한 힙 메모리 디버거 (콘솔)</p>
  </a>
  

</div>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



  <!-- image lazy load: https://github.com/ApoorvSaxena/lozad.js -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

<script type="text/javascript">
  const imgs = document.querySelectorAll('.post-content img');
  const observer = lozad(imgs);
  observer.observe();
</script>




        <!--
  The Footer
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://github.com/rito15">Rito15</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-xl-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/csharp/">csharp</a>
      
        
        <a class="post-tag" href="/tags/unity/">unity</a>
      
        
        <a class="post-tag" href="/tags/editor/">editor</a>
      
        
        <a class="post-tag" href="/tags/shader/">shader</a>
      
        
        <a class="post-tag" href="/tags/memo/">memo</a>
      
        
        <a class="post-tag" href="/tags/graphics/">graphics</a>
      
        
        <a class="post-tag" href="/tags/opengl/">opengl</a>
      
        
        <a class="post-tag" href="/tags/thread/">thread</a>
      
        
        <a class="post-tag" href="/tags/amplify/">amplify</a>
      
        
        <a class="post-tag" href="/tags/plugin/">plugin</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
  $(function() {
    let initTheme = "default";

    if ($("html[mode=dark]").length > 0
      || ($("html[mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="https://rito15.github.io{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    <div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div>    <div><i class="fa fa-tag fa-fw"></i>{tags}</div>  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>'
});
</script>


    <!-- 2021-06-29 추가 : 애널리틱스 적용 -->
    <!--
  The GA snippet
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JV8DN2JPP7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JV8DN2JPP7');
</script>

  </body>

</html>

