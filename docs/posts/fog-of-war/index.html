<!DOCTYPE html>



<html lang="en" 
  
    mode="dark"
  
>

  <!--
  The Head
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="theme" content="Chirpy v2.7.2">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Fog of War" />
<meta name="author" content="Rito15" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="개념 맵과 크기가 동일한 RGBA(0, 0, 0, a)의 텍스쳐를 이용해 지정한 유닛들의 주변시야를 표현한다. 지정한 유닛이 현재 위치한 원형 범위 내 영역들은 a = 0, 지정한 유닛이 한 번이라도 위치했던 영역들은 a = 0.5~0.8, 지정한 유닛이 한 번도 방문하지 않은 영역은 a = 1로 표현한다." />
<meta property="og:description" content="개념 맵과 크기가 동일한 RGBA(0, 0, 0, a)의 텍스쳐를 이용해 지정한 유닛들의 주변시야를 표현한다. 지정한 유닛이 현재 위치한 원형 범위 내 영역들은 a = 0, 지정한 유닛이 한 번이라도 위치했던 영역들은 a = 0.5~0.8, 지정한 유닛이 한 번도 방문하지 않은 영역은 a = 1로 표현한다." />
<link rel="canonical" href="https://rito15.github.io/posts/fog-of-war/" />
<meta property="og:url" content="https://rito15.github.io/posts/fog-of-war/" />
<meta property="og:site_name" content="Rito15" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-20T21:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fog of War" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"description":"개념 맵과 크기가 동일한 RGBA(0, 0, 0, a)의 텍스쳐를 이용해 지정한 유닛들의 주변시야를 표현한다. 지정한 유닛이 현재 위치한 원형 범위 내 영역들은 a = 0, 지정한 유닛이 한 번이라도 위치했던 영역들은 a = 0.5~0.8, 지정한 유닛이 한 번도 방문하지 않은 영역은 a = 1로 표현한다.","datePublished":"2021-01-20T21:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://rito15.github.io/posts/fog-of-war/"},"url":"https://rito15.github.io/posts/fog-of-war/","author":{"@type":"Person","name":"Rito15"},"headline":"Fog of War","dateModified":"2021-02-05T03:35:32+09:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Fog of War | Rito15
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2019 Cotes Chung
  Published under the MIT license
-->



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
  Chirpy v2.3
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT Licensed
-->






<link rel="preload" href="/assets/css/post.css" as="style">
<link rel="stylesheet" href="/assets/css/post.css">


  
    <link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css">
    <link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" />
  



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
  Chirpy v2.3
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT Licensed
-->





<script async src="/assets/js/post.min.js"></script>


  <!-- MathJax -->
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/favicons/android-icon-192x192.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Rito15</a>
    </div>

    <div class="site-subtitle font-italic">Unity Csharp Developer</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/tabs/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tabs/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tabs/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tabs/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/rito15" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ghdtkals15','gmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->
<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">
      
        
        <span>
          <a href="/">
            Posts
          </a>
        </span>
        
      

      
        <span>Fog of War</span>
      

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Fog of War</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Wed, Jan 20, 2021,  9:00 PM +0900"
  >

  
  

  
    Jan 20
  

  <i class="unloaded">2021-01-20T21:00:00+09:00</i>

</span>
          by
          <span class="author">
            Rito15
          </span>
        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            Updated
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Fri, Feb  5, 2021,  3:35 AM +0900"
  >

  
  

  
    Feb  5
  

  <i class="unloaded">2021-02-05T03:35:32+09:00</i>

</span>
          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->






<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2996 words">16 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h1 id="개념">개념</h1>
<hr />
<ul>
  <li>맵과 크기가 동일한 RGBA(0, 0, 0, a)의 텍스쳐를 이용해 지정한 유닛들의 주변시야를 표현한다.</li>
  <li>지정한 유닛이 현재 위치한 원형 범위 내 영역들은 a = 0,</li>
  <li>지정한 유닛이 한 번이라도 위치했던 영역들은 a = 0.5~0.8,</li>
  <li>지정한 유닛이 한 번도 방문하지 않은 영역은 a = 1로 표현한다.</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105794184-d7e55f00-5fcd-11eb-9ccc-5e9065a3cfba.png" alt="" /></p>
<center>[스타크래프트2 게임 플레이 화면]</center>

<p><br /></p>

<h1 id="구현-방법">구현 방법</h1>
<hr />

<h2 id="1-카메라와-지상-사이에-검정색-plane-사용">[1] 카메라와 지상 사이에 검정색 Plane 사용</h2>

<ul>
  <li>
    <p>시야의 역할을 해줄 Plane을 카메라와 지상 사이에 위치시킨다.</p>
  </li>
  <li>
    <p>맵 전체를 좌표 형태의 2차원 배열로 관리하여, 유닛들이 현재 위치한 영역, 방문했던 영역, 한 번도 방문하지 않은 영역의 정보를 실시간으로 저장한다.</p>
  </li>
  <li>
    <p>카메라와 해당 유닛들 사이에서 Plane 위의 시야 중심 좌표를 구하고,
로컬 좌표로 변환하여 해당 좌표를 기준으로 원형 범위 내의 정점 색상들을 변경시킨다.</p>
  </li>
  <li>
    <p>Plane 위의 시야 중심 좌표를 구하는 방법 : 레이캐스트 또는 비례식 사용</p>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>* 비례식 이용하여 좌표 구하기

&lt;정의&gt;
- 카메라의 좌표 : (cX, cY, cZ)
- 유닛의 좌표 : (uX, uY, uZ)
- 구해야 할 plane 위의 정점 좌표 : (pX, pY, pZ)

pX - cX : uX - cX = cY - pY : cY 이고,

cY(pX - cX) = (uX - cX)(cY - pY),

pX - cX = (uX - cX)(cY - pY)/cY,

pX = (uX - cX)(cY - pY)/cY + cX 이다.

pX, pZ를 제외한 모든 값을 사전에 알고 있으며

동일한 방법으로 pZ도 구할 수 있다.

</pre></td></tr></tbody></table></code></div></div>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534824-6a1d0700-5d31-11eb-8125-3610abd888b3.png" width="500" /></p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534838-6e492480-5d31-11eb-8914-546fc287e45f.png" width="500" /></p>

<p><br /></p>

<h2 id="2-타일맵-기반-구현">[2] 타일맵 기반 구현</h2>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534813-65f0e980-5d31-11eb-9151-9d8859e12acc.png" width="500" /></p>

<p><br /></p>

<h1 id="타일맵을-이용한-구현">타일맵을 이용한 구현</h1>
<hr />

<h3 id="타일맵"><strong>타일맵</strong></h3>

<ul>
  <li>
    <p>정사각형 타일 하나의 가로, 세로 너비와 Plane의 가로, 세로 너비를 결정한다.</p>

    <p>(예 : 타일 0.5x0.5, Plane 20x20 -&gt; 타일 개수 : (20/0.5 * 20/0.5) = 1600개 )</p>
  </li>
  <li>
    <p>게임 시작 시 각각의 타일마다 지형의 높이(position.y)를 계산해 2차원 배열로 저장한다.</p>

    <p>(-Y 방향 레이캐스트 이용, 배열의 크기는 타일의 가로 개수x세로 개수)</p>
  </li>
</ul>

<p><br /></p>

<h3 id="유닛"><strong>유닛</strong></h3>
<ul>
  <li>시야를 밝힐 대상 유닛들은 리스트를 통해 실시간으로 관리된다.</li>
</ul>

<p><br /></p>

<h3 id="visit-배열"><strong>Visit 배열</strong></h3>

<ul>
  <li>
    <p>배열의 크기는 타일의 개수와 같다.</p>
  </li>
  <li>
    <p>Visit.current 배열은 현재 유닛들의 시야가 유지되는 타일들에 대해 true 값을 가지며,</p>

    <p>매 주기마다 시야 계산을 하기 전에 전체를 false로 초기화한다.</p>
  </li>
  <li>
    <p>Visit.ever 배열은 한 번이라도 시야가 확보됐던 타일들에 대해 true값을 가지며,</p>

    <p>한 번 true가 된 타일은 항상 그 값을 true로 유지한다.</p>
  </li>
  <li>
    <p>주기적인 시야 계산을 통해 Visit 배열을 갱신한다.</p>
  </li>
</ul>

<p><br /></p>

<h3 id="시야-계산"><strong>시야 계산</strong></h3>

<ul>
  <li>
    <p>주기적으로(0.2~0.5초) 각 유닛들이 위치한 타일 기준으로 주변의 시야를 계산한다.</p>

    <ul>
      <li>[1] 유닛의 시야 만큼의 원형 범위 내 모든 타일들을 가져와 검사한다.</li>
    </ul>

    <center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534301-a56b0600-5d30-11eb-9c2c-1695ecf657cc.png" width="250" /></center>

    <ul>
      <li>[2] 현재 유닛 타일보다 높은 곳에 위치한 타일들은 배제한다.</li>
    </ul>

    <center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534318-aa2fba00-5d30-11eb-8f32-303b340ecd35.png" width="250" /></center>

    <ul>
      <li>[3] 장애물 검사 알고리즘을 통해, 유닛과 해당 타일 사이에 장애물이 위치하는 경우 해당 타일을 배제한다.</li>
    </ul>

    <center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534332-adc34100-5d30-11eb-84e1-e3acde754022.png" width="250" /></center>

    <ul>
      <li>[4] 결과로 얻은 타일들에 대해 Visit.current 및 Visit.ever 배열의 해당 값들을 true로 초기화한다.</li>
    </ul>

    <center><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534342-b156c800-5d30-11eb-81d9-76480f4c9dcb.png" width="250" /></center>
  </li>
</ul>

<p><br /></p>

<h2 id="장애물-검사-알고리즘"><strong>장애물 검사 알고리즘</strong></h2>
<ul>
  <li>
    <p>시야 계산을 위해, 목표 지점의 타일과 유닛이 위치한 타일 사이에</p>

    <p>유닛보다 더 높은 위치에 있는 타일(장애물)이 존재하는지 검사하는 알고리즘</p>
  </li>
</ul>

<p><br /></p>

<h3 id="1-내적을-이용한-알고리즘">1. 내적을 이용한 알고리즘</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>&lt;정의&gt;
 - U : 유닛이 위치한 타일
 - C : 현재 검사 중인 타일
 - O : 장애물 타일(U보다 더 높은 위치에 있는 타일)
 - AB : XY평면에서 A에서 B를 향하는 직선
 - dist(AB) : XY평면에서 A와 B 사이의 직선거리
 - nDot(AB, AC) : XY 평면에서 AB, AC를 각각 정규화한 값을 서로 내적한 값
 - T : 시야를 밝힐 수 있는 타일
 - F : 시야를 밝힐 수 없는 타일

 [1] U 기준으로 원형 범위 내에 있는 모든 타일들을 리스트(InRangeList)로 가져온다.

 [2] 그 중, O에 해당하는 타일들은
    InRangeList에 넣지 않고 장애물 리스트(ObstacleList)에 넣는다.

 [2-1] ObstacleList의 크기가 0인 경우,
       InRangeList 내 모든 타일들을 T로 설정하고 [5]로 이동한다.

 [3] ObstacleList를 유닛과 장애물 타일 사이의 XY평면상 직선거리로 오름차순 정렬한다.

 [4] InRangeList 내 모든 타일들에 대해 각각 순회하며 검사한다.

   [4-1] UC가 UO의 최솟값보다 작은 경우 C &lt;- T

   [4-2] dist(UC) &gt; dist(UO)이면서 nDot(UC, UO) &gt; 0.9인 O가 존재하지 않는 경우 C &lt;- T

   [4-3] [4-1], [4-2]에 모두 해당하지 않는 경우 C &lt;- F

 [5] 모든 T에 대해 시야를 밝힌다.
</pre></td></tr></tbody></table></code></div></div>

<p><br /></p>
<h3 id="2-타일-전진-알고리즘">2. 타일 전진 알고리즘</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>&lt;정의&gt;
 - U : 유닛이 위치한 타일
 - C : 현재 검사 중인 목표 타일
 - O : 장애물 타일(유닛보다 더 높은 위치에 있는 타일)
 - G :U와 C를 지나는 직선의 기울기
 - aG : G의 절댓값
 - T : 시야를 밝힐 수 있는 타일
 - F : 시야를 밝힐 수 없는 타일

U와 C의 관계를 4가지로 분류하여 진행한다.

[1] 동일한 X좌표를 가진 경우
 - U에서 C까지 Y좌표를 한 칸씩 전진시킨다.
 - C에 도달할 때까지 O를 하나라도 발견하면 C &lt;- F
 - O를 발견하지 못하면 C &lt;- T

[2] 동일한 Y좌표를 가진 경우
 - U에서 C까지 X좌표를 한 칸씩 전진시키며, [1]과 같다.

[3] aG &gt;= 1인 경우
 - U로부터 X축으로 전진한 거리의 절댓값을 aX,
           Y축으로 전진한 거리의 절댓값을 aY라고 정의한다.
 - C에 도달할 때까지 aX / (aY+1) &lt; aG일 때 X축으로 1칸 전진하며,
   aX / (aY+1) &gt;= aG일 때는 Y축으로 1칸 전진한다.
 - O를 하나라도 발견한 경우 C &lt;- F, 발견하지 못한 경우 C &lt;- T

[4] aG &lt; 1인 경우
 - aX, aY의 정의는 [3]과 같다.
 - C에 도달할 때까지 aY / (aX+1) &lt; aG일 때 Y축으로 1칸 전진하며,
   aY / (aX+1) &gt;= aG일 때는 X축으로 1칸 전진한다.
 - O를 하나라도 발견한 경우 C &lt;- F, 발견하지 못한 경우 C &lt;- T

결과로 얻은 모든 T에 대해 시야를 밝힌다.
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>그림으로 표현하면 다음과 같다.</p>

    <p>(초록색 : 유닛 위치, 파란색 : 시야 탐색 대상, 갈색 : 장애물)</p>
  </li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105710978-3ae9de00-5f5b-11eb-9254-50a1a795e6a7.png" alt="" /></p>

<ul>
  <li>장애물을 발견하지 못한 경우(C &lt;- T) :</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105710803-f52d1580-5f5a-11eb-876a-95a0d1349507.gif" alt="" /></p>

<ul>
  <li>장애물을 발견한 경우(C &lt;- F) :</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105710793-f0686180-5f5a-11eb-9689-0a3accb4221a.gif" alt="" /></p>

<ul>
  <li>
    <p>그림 내에 보이는 모든 타일에 대한 T/F 판정 :</p>

    <p>(T : 초록색, F : 빨간색)</p>
  </li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105741844-1eab6880-5f7e-11eb-8980-0fa71778f14b.gif" alt="" /></p>

<p><br /></p>

<h3 id="fog-텍스쳐"><strong>Fog 텍스쳐</strong></h3>

<ul>
  <li>
    <p>텍스쳐의 색상 저장을 위한 Color 배열이 필요하며, 크기는 타일의 개수와 같다.</p>
  </li>
  <li>
    <p>Fog 텍스쳐의 넓이는 타일의 가로 개수 * 세로 개수와 같다.</p>
  </li>
  <li>
    <p>시야 계산이 끝날 때마다 Visit.current, Visit.ever 값에 따라 Color 배열의 알파값을 지정한다.
(current -&gt; 0, ever -&gt; 0.5 ~ 0.8, 미방문 타일 1)</p>
  </li>
  <li>
    <p>Color 배열을 텍스쳐에 적용한다.</p>
  </li>
</ul>

<p><br /></p>

<h3 id="fog-쉐이더"><strong>Fog 쉐이더</strong></h3>

<ul>
  <li>Fog 쉐이더는 ZTest Off로 설정하여 항상 다른 오브젝트들 위에 보이게 한다.</li>
</ul>

<p><br /></p>

<h3 id="블러-보간-효과"><strong>블러, 보간 효과</strong></h3>

<ul>
  <li>
    <p>시야 계산이 끝날 때마다 쉐이더를 통해 가우시안 블러를 적용한다.</p>
  </li>
  <li>
    <p>부자연스러운 픽셀이 나타나는 것을 방지하기 위해 렌더 텍스쳐를 여러 장 거쳐 가우시안 블러를 적용한다.</p>
  </li>
  <li>
    <p>매 프레임마다 이전 프레임의 시야 텍스쳐를 현재 프레임의 텍스쳐에 부드럽게 보간하여 적용한다.</p>
  </li>
</ul>

<p><br /></p>

<h1 id="구현-결과">구현 결과</h1>
<hr />

<h3 id="1-gizmo를-통해-유닛의-가시-영역-확인">[1] Gizmo를 통해 유닛의 가시 영역 확인</h3>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534346-b451b880-5d30-11eb-9f4a-3bb0b35c069b.gif" width="500" /></p>

<h3 id="2-실제-게임-뷰에서-시야-변화-확인">[2] 실제 게임 뷰에서 시야 변화 확인</h3>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105534357-b6b41280-5d30-11eb-9ffa-c6a6e3d9ab3c.gif" width="500" /></p>

<p><br /></p>

<h1 id="프로파일링-최적화">프로파일링, 최적화</h1>
<hr />

<h2 id="job--burst-compiler-적용">Job + Burst Compiler 적용</h2>

<ul>
  <li>장애물 검사 알고리즘은 타일 전진 알고리즘을 사용했으며, 프로파일링 결과 주요 병목이라고 생각하여 Job System을 적용해보았다.</li>
</ul>

<h2 id="테스트-1">테스트 1</h2>
<ul>
  <li>Fog Width : 40x40</li>
  <li>Tile Size : 1</li>
  <li>Update Cycle : 0.2</li>
  <li>Number of Units : 105</li>
  <li>상단 : 미적용 / 하단 : 적용</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105628627-541e5c00-5e81-11eb-80ef-7407205732d9.png" width="500" /></p>

<h2 id="테스트-2">테스트 2</h2>
<ul>
  <li>Fog Width : 40x40</li>
  <li>Tile Size : 0.5</li>
  <li>Update Cycle : 0.5</li>
  <li>Number of Units : 105</li>
  <li>상단 : 미적용 / 하단 : 적용</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/105628633-5a143d00-5e81-11eb-9c66-c033740ed202.png" width="500" /></p>

<h2 id="잡-시스템-적용-결과">잡 시스템 적용 결과</h2>
<ul>
  <li>별 차이가 없다. 그래서 프로파일링을 구체화해서 다시 확인해보았다.</li>
</ul>

<p><br /></p>

<h2 id="병목-재확인-및-최적화">병목 재확인 및 최적화</h2>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106707159-2335e800-6634-11eb-9f7f-123375a5c648.png" alt="image" /></p>

<ul>
  <li>예상 외의 결과였다.</li>
  <li>
    <p>ComputeFog_1 부분은 시야 범위 타일 얻어오기, 2는 위에서 잡으로 돌린 장애물 계산, 3이 시야 정보를 업데이트하고 Blit하는 부분이다.</p>
  </li>
  <li>그래서 GPU 병목이겠거니 하고 더 세분화 했는데,</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106708801-d1429180-6636-11eb-81c5-e3b0a1e03f35.png" alt="image" /></p>

<ul>
  <li>저부분은..</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106709032-3ac2a000-6637-11eb-9eaa-52ee52e995f4.png" alt="image" /></p>

<ul>
  <li>
    <p>단순히 방문 정보를 이용해 컬러 배열의 알파값을 초기화하는 부분이었다.</p>
  </li>
  <li>그래서 방문 정보를 저장하는 방식을 바꿨다.</li>
  <li>기존에는</li>
</ul>

<div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">struct</span> <span class="nc">Visit</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt; 현재 위치함 &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="n">current</span><span class="p">;</span>

    <span class="c1">/// &lt;summary&gt; 과거에 방문한 적 있음 &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="n">ever</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="n">Visit</span><span class="p">[]</span> <span class="n">visit</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>두 개의 bool 변수를 이용해 방문 여부, 과거 방문, 미방문으로 구분했지만</li>
  <li>변경 이후</li>
</ul>

<div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="kt">float</span><span class="p">[]</span> <span class="n">visit</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>이렇게 단순히 float 배열을 통해 알파값을 직접 배열에 넣고,</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106710494-5fb81280-6639-11eb-993d-75d526e63b4e.png" alt="" /></p>

<ul>
  <li>컬러 버퍼에는 그 알파값을 직접 넣도록 변경했다.</li>
  <li>그 결과,</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106710195-e5878e00-6638-11eb-9cdc-e2c97247c64a.png" alt="" /></p>

<ul>
  <li>이 부분의 병목을 많이 줄일 수 있었다.</li>
</ul>

<p><br /></p>

<h2 id="가비지-최적화">가비지 최적화</h2>

<ul>
  <li>
    <p>ComputeFog(), GetVisibleTilesInRange() 메소드 내에서 List를 지역적으로 할당하여 사용하는 부분이 세 군데 있었다.</p>
  </li>
  <li>
    <p>예를 들어,</p>
  </li>
</ul>

<div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="n">List</span><span class="p">&lt;</span><span class="n">FowTile</span><span class="p">&gt;</span> <span class="n">tilesInSight</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">FowTile</span><span class="p">&gt;();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="p">-</span><span class="n">sightRangeInt</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="n">sightRangeInt</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="p">-</span><span class="n">sightRangeInt</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;=</span> <span class="n">sightRangeInt</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">*</span> <span class="n">i</span> <span class="p">+</span> <span class="n">j</span> <span class="p">*</span> <span class="n">j</span> <span class="p">&lt;=</span> <span class="n">rangeSquare</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">tile</span> <span class="p">=</span> <span class="nf">GetTile</span><span class="p">(</span><span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="n">j</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tile</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">tilesInSight</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">tile</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>이런 부분들에서 사용하는 List를 모두 필드로 옮겨주고</li>
</ul>

<div class="language-cs highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">tilesInSight</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
<span class="c1">// ... Same Codes</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>이렇게 Clear()하여 재사용하는 방식으로 바꾸어 주었더니</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106890595-e7327e00-672c-11eb-890c-3514859037ae.png" alt="" class="normal" /></p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106890874-48f2e800-672d-11eb-81bc-7bb456287b6f.png" alt="" class="normal" /></p>

<ul>
  <li>GC 호출을 크게 줄일 수 있었다.</li>
</ul>

<p><br /></p>
<ul>
  <li>프로파일링 결과 :</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106938307-27602380-6762-11eb-95bf-f9c5c7d37d6b.png" alt="image" class="normal" /></p>

<ul>
  <li>Fog Width : 40x40</li>
  <li>Tile Size : 1</li>
  <li>Update Cycle : 0.2</li>
  <li>Number of Units : 105</li>
</ul>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/42164422/106938647-9a699a00-6762-11eb-9ea9-a0f630267c9c.png" alt="image" class="normal" /></p>

<p><br /></p>

<h1 id="reference">Reference</h1>
<hr />
<ul>
  <li><a href="https://github.com/QinZhuo/FogOfWar_ForUnity">https://github.com/QinZhuo/FogOfWar_ForUnity</a></li>
</ul>

<p><br /></p>

<h1 id="source-code">Source Code</h1>
<hr />
<ul>
  <li><a href="https://github.com/rito15/UnityStudy2">https://github.com/rito15/UnityStudy2</a></li>
</ul>

<p><br /></p>

<h1 id="download">Download</h1>
<hr />
<ul>
  <li><a href="https://github.com/rito15/Images/files/5927774/2021_0205_Fog.of.War.zip">2021_0205_Fog of War.zip</a></li>
</ul>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/unity/'>Unity</a>,
            <a href='/categories/unity-study/'>Unity Study</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/unity/"
            class="post-tag no-text-decoration" >unity</a>
          
          <a href="/tags/csharp/"
            class="post-tag no-text-decoration" >csharp</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet

 v2.1
 https://github.com/cotes2020/jekyll-theme-chirpy
 © 2019 Cotes Chung
 Published under the MIT License
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Fog of War - Rito15&url=https://rito15.github.io/posts/fog-of-war/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Fog of War - Rito15&u=https://rito15.github.io/posts/fog-of-war/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Fog of War - Rito15&url=https://rito15.github.io/posts/fog-of-war/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/posts/opengl-study-01/">OpenGL 공부 - 01</a></li>
      
        
        
        
        <li><a href="/posts/fog-of-war/">Fog of War</a></li>
      
        
        
        
        <li><a href="/posts/unity-profiling/">Unity Profiling</a></li>
      
        
        
        
        <li><a href="/posts/unity-profiler-window/">Unity Profiler Window</a></li>
      
        
        
        
        <li><a href="/posts/popup-ui-management-system/">Popup UI Management System</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/csharp/">csharp</a>
      
        
        <a class="post-tag" href="/tags/unity/">unity</a>
      
        
        <a class="post-tag" href="/tags/graphics/">graphics</a>
      
        
        <a class="post-tag" href="/tags/opengl/">opengl</a>
      
        
        <a class="post-tag" href="/tags/plugin/">plugin</a>
      
        
        <a class="post-tag" href="/tags/shader/">shader</a>
      
        
        <a class="post-tag" href="/tags/profiling/">profiling</a>
      
        
        <a class="post-tag" href="/tags/cpp/">cpp</a>
      
        
        <a class="post-tag" href="/tags/optimization/">optimization</a>
      
        
        <a class="post-tag" href="/tags/shadergraph/">shadergraph</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.

 v2.0
 https://github.com/cotes2020/jekyll-theme-chirpy
 © 2019 Cotes Chung
 Published under the MIT License
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/behavior-tree/">
          <div class="card-body">
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago small"
  >

  
  

  
    Jan  5
  

  <i class="unloaded">2021-01-05T00:26:00+09:00</i>

</span>
            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Behavior Tree</h3>
            <div class="text-muted small">
              <p>
                





                개념



  FSM (Finite State Machine)의 단점을 보완하기 위해 만들어진 기법
  FSM에서는 상태 전이 조건을 모두 각각의 상태에서 검사하지만, BT에서는 상태 동작 뿐만 아니라 전이 조건도 노드로 관리한다.
  노드 그래프를 통해 시각화하거나 params, 빌더 패턴 등을 활용하여 스크립트 내에서도 가독성 좋게 구성할 수 있다...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/ray-marching/">
          <div class="card-body">
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago small"
  >

  
  

  
    Jan 19
  

  <i class="unloaded">2021-01-19T23:15:00+09:00</i>

</span>
            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ray Marching</h3>
            <div class="text-muted small">
              <p>
                





                레이 마칭이란?



  
    폴리곤의 정점 정보를 이용하는 기존의 3D 렌더링 방식과는 달리, 레이를 전진시켜(Ray Marching) 표면의 정보를 얻어 오브젝트를 그려내는 기법
  
  
    레이 마칭의 모든 모델링들은 폴리곤이 아닌 거리 함수(SDF : Signed Distance Function)로 표면의 정보가 계산된다.
  



...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/job-system/">
          <div class="card-body">
            <!--
  Date format snippet

  v2.4.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->
<span class="timeago small"
  >

  
  

  
    Jan 24
  

  <i class="unloaded">2021-01-24T13:15:00+09:00</i>

</span>
            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Job System</h3>
            <div class="text-muted small">
              <p>
                





                개념


  유니티에서 안전한 멀티스레딩을 구현하는 시스템
  스레드를 별도로 생성하지 않으며, 유니티의 워커스레드에 작업을 지시할 수 있게 한다.
  잡 대기열에 잡을 배치하면 워커 스레드가 잡 대기열에서 항목을 가져와 실행한다.
  Native Container를 이용해 잡의 수행 결과를 메인 스레드와 공유한다.
  버스트 컴파일러를 이용하여 추가...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.

  v2.1
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2020 Cotes Chung
  MIT License
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/ray-marching/" class="btn btn-outline-primary">
    <p>Ray Marching</p>
  </a>
  

  
  <a href="/posts/job-system/" class="btn btn-outline-primary">
    <p>Job System</p>
  </a>
  

</div>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



  <!-- image lazy load: https://github.com/ApoorvSaxena/lozad.js -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

<script type="text/javascript">
  const imgs = document.querySelectorAll('.post-content img');
  const observer = lozad(imgs);
  observer.observe();
</script>




        <!--
  The Footer
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://github.com/rito15">Rito15</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-xl-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/csharp/">csharp</a>
      
        
        <a class="post-tag" href="/tags/unity/">unity</a>
      
        
        <a class="post-tag" href="/tags/graphics/">graphics</a>
      
        
        <a class="post-tag" href="/tags/opengl/">opengl</a>
      
        
        <a class="post-tag" href="/tags/plugin/">plugin</a>
      
        
        <a class="post-tag" href="/tags/shader/">shader</a>
      
        
        <a class="post-tag" href="/tags/profiling/">profiling</a>
      
        
        <a class="post-tag" href="/tags/cpp/">cpp</a>
      
        
        <a class="post-tag" href="/tags/optimization/">optimization</a>
      
        
        <a class="post-tag" href="/tags/shadergraph/">shadergraph</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
  $(function() {
    let initTheme = "default";

    if ($("html[mode=dark]").length > 0
      || ($("html[mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  v2.0
  https://github.com/cotes2020/jekyll-theme-chirpy
  © 2017-2019 Cotes Chung
  MIT License
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="https://rito15.github.io{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    <div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div>    <div><i class="fa fa-tag fa-fw"></i>{tags}</div>  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>'
});
</script>


  </body>

</html>

